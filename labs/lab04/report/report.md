---
## Front matter
title: "Отчёт по лабораторной работе №4"
subtitle: "Работа с программными пакетами"
author: "Тукаев Тимур"

## Generic otions
lang: ru-RU
toc-title: "Содержание"

## Bibliography
bibliography: bib/cite.bib
csl: pandoc/csl/gost-r-7-0-5-2008-numeric.csl

## Pdf output format
toc: true
toc-depth: 2
lof: true
lot: true
fontsize: 12pt
linestretch: 1.5
papersize: a4
documentclass: scrreprt
## I18n polyglossia
polyglossia-lang:
  name: russian
  options:
    - spelling=modern
    - babelshorthands=true
polyglossia-otherlangs:
  name: english
## I18n babel
babel-lang: russian
babel-otherlangs: english
## Fonts
mainfont: IBM Plex Serif
romanfont: IBM Plex Serif
sansfont: IBM Plex Sans
monofont: IBM Plex Mono
mathfont: STIX Two Math
mainfontoptions: Ligatures=Common,Ligatures=TeX,Scale=0.94
romanfontoptions: Ligatures=Common,Ligatures=TeX,Scale=0.94
sansfontoptions: Ligatures=Common,Ligatures=TeX,Scale=MatchLowercase,Scale=0.94
monofontoptions: Scale=MatchLowercase,Scale=0.94,FakeStretch=0.9
mathfontoptions:
## Biblatex
biblatex: true
biblio-style: "gost-numeric"
biblatexoptions:
  - parentracker=true
  - backend=biber
  - hyperref=auto
  - language=auto
  - autolang=other*
  - citestyle=gost-numeric
## Pandoc-crossref LaTeX customization
figureTitle: "Рис."
tableTitle: "Таблица"
listingTitle: "Листинг"
lofTitle: "Список иллюстраций"
lotTitle: "Список таблиц"
lolTitle: "Листинги"
## Misc options
indent: true
header-includes:
  - \usepackage{indentfirst}
  - \usepackage{float}
  - \floatplacement{figure}{H}
---

# Цель работы

Получить навыки работы с репозиториями и менеджерами пакетов.

# Выполнение

## Работа с репозиториями

1. Переход в режим суперпользователя выполнен с использованием команды `su -`.  
   После ввода пароля оболочка переключилась в контекст root-пользователя.

2. Выполнен переход в каталог `/etc/yum.repos.d`, изучено содержимое каталога и файлов репозиториев.  
   В файле `rocky.repo` рассмотрены параметры репозитория: mirrorlist, gpgcheck, enabled, путь к GPG-ключу.

   ![Просмотр содержания репозитория](Screenshot_1.png){ #fig:001 width=80% }


3. Выведен список репозиториев.  
   Отображены активные репозитории: AppStream, BaseOS, SIG Core Common, Extras.

   ![Список репозиториев](Screenshot_2.png){ #fig:002 width=80% }

4. Выполнен поиск пакетов, содержащих слово *user* в имени или описании.  
   В результатах присутствуют библиотеки управления пользователями, документация, инструменты user-space и компоненты графических окружений.

   ![Поиск пакетов по слову user](Screenshot_3.png){ #fig:003 width=80% }

5. Выполнен поиск пакетов `nmap`, просмотрена их информация и произведена установка.  
   Разница между установками:

   - `install nmap` — устанавливает только основной пакет nmap  
   - `install nmap*` — устанавливает все пакеты, начинающиеся с "nmap" (включая nmap-ncat)

   ![Информация о пакете nmap](Screenshot_4.png){ #fig:004 width=80% }

   ![Установка nmap](Screenshot_5.png){ #fig:005 width=80% }

6. Выполнено удаление пакетов:

   - `remove nmap` — удаляет только пакет nmap  
   - `remove nmap*` — удаляет также nmap-ncat и другие связанные пакеты  

   ![Удаление пакетов nmap](Screenshot_6.png){ #fig:006 width=80% }

7. Получен список групп пакетов, изучена группа `RPM Development Tools`, затем выполнена установка и удаление данной группы.  
   Группа включает инструменты для сборки RPM-пакетов (rpmdevtools, rpm-build и др.).

   ![Список групп пакетов](Screenshot_7.png){ #fig:007 width=80% }

   ![Удаление группы RPM Development Tools](Screenshot_8.png){ #fig:008 width=80% }

8. Просмотрена история транзакций dnf.  
   Выполнен откат транзакции с помощью команды `history undo`.

   ![История dnf и отмена транзакции](Screenshot_9.png){ #fig:009 width=80% }

## Использование rpm

1. Был выполнен поиск пакета lynx в доступных репозиториях и загружен rpm-пакет без установки.  
   Команда `install --downloadonly` сохранила пакет в кэш DNF, не устанавливая его в систему.

   ![Загрузка пакета lynx](Screenshot_10.png){ #fig:010 width=80% }

2. Выполнён поиск каталога, в который был загружен rpm-пакет.  
   В результате найден путь `/var/cache/dnf/appstream-.../packages/lynx-2.9.0-6.el10.x86_64.rpm`.

3. Выполнен переход в каталог, где расположен пакет, и произведена установка с помощью rpm:  
   установка прошла успешно, о чём свидетельствует вывод «Updating / installing…».

   ![Установка rpm-пакета](Screenshot_11.png){ #fig:011 width=80% }

4. Определено расположение исполняемого файла lynx.  
   Исполняемый файл расположен по пути `/usr/bin/lynx`.

5. Определено, к какому пакету принадлежит исполняемый файл, и получена информация о пакете.  
   Пакет — `lynx-2.9.0-6.el10.x86_64`.  
   Команда `rpm -qi lynx` выдала сведения о версии, архитектуре, размере, лицензии, описании программы и её назначении.

   ![Информация о пакете lynx](Screenshot_12.png){ #fig:012 width=80% }

6. Выведен список всех файлов, входящих в пакет lynx, включая исполняемые файлы, библиотеки, конфигурации и документацию.  
   Затем была выведена документация пакета командой `rpm -qd lynx`.  
   После этого открыт man-раздел программы lynx.

   ![Список файлов и документации lynx](Screenshot_13.png){ #fig:013 width=80% }

   ![man lynx](Screenshot_14.png){ #fig:014 width=80% }

7. Получен перечень конфигурационных файлов пакета lynx.  
   Конфигурационные файлы размещаются в каталоге `/etc/` и включают:

   - `/etc/lynx-site.cfg`
   - `/etc/lynx.cfg`
   - `/etc/lynx.lss`

   ![Конфигурационные файлы lynx](Screenshot_15.png){ #fig:015 width=80% }

8. Просмотрены скрипты, выполняемые при установке пакета (`preinstall`, `postinstall`, `preuninstall`, `postuninstall`).  
   Скрипты используются для:

   - подготовки среды перед установкой,
   - выполнения действий после установки (например, обновление кэша или создание каталогов),
   - корректного удаления пакета.

9. В отдельном терминале был запущен текстовый браузер lynx под обычным пользователем.  
   Браузер открыл стартовую страницу Rocky Linux, что подтверждает корректность установки.

   ![Запуск lynx](Screenshot_16.png){ #fig:016 width=80% }

10. После проверки работы программы был выполнен возврат в терминал root и удаление пакета командой `rpm -e lynx`.  
    Далее выполнена проверка содержимого каталога — rpm-файл пакета остался в кэше, но сам пакет удалён из системы.

## Установка dnsmasq из rpm-пакета

1. Был выполнен поиск пакета dnsmasq в репозиториях, после чего пакет установлен вместе с зависимостью nettle.  
   Затем определено расположение исполняемого файла dnsmasq — он находится по пути `/usr/sbin/dnsmasq`.

   ![Установка dnsmasq](Screenshot_17.png){ #fig:017 width=80% }

2. Определено, к какому пакету принадлежит исполняемый файл dnsmasq.  
   Команда `rpm -qf $(which dnsmasq)` показала, что бинарный файл относится к пакету `dnsmasq-2.90-4.el10.x86_64`.  
   Далее была получена подробная информация о пакете: версия, архитектура, дата установки, лицензия, URL проекта, назначение пакета и его описание.

   ![Информация о пакете dnsmasq](Screenshot_18.png){ #fig:018 width=80% }

3. Получен полный список файлов, входящих в пакет dnsmasq: исполняемые файлы, конфигурации, системные службы, документация и лицензии.  
   Отдельно был просмотрен перечень файлов документации — в него входят файлы FAQ, описания интерфейсов, CHANGES, HTML-документация и man-страницы.  
   После этого был открыт man-раздел dnsmasq, содержащий описание возможностей сервера DNS/DHCP/TFTP.

   ![Список файлов и документации dnsmasq](Screenshot_19.png){ #fig:019 width=80% }

   ![man dnsmasq](Screenshot_20.png){ #fig:020 width=80% }

4. Был выведен список конфигурационных файлов пакета dnsmasq.  
   Конфигурации размещаются в следующих путях:

   - `/etc/dnsmasq.conf`
   - `/etc/dbus-1/system.d/dnsmasq.conf`
   - `/etc/dnsmasq.d/`
   - `/usr/lib/sysusers.d/dnsmasq.conf`
   - `/usr/lib/systemd/system/dnsmasq.service`

   Эти файлы определяют настройки DNS, DHCP, PXE, а также параметры взаимодействия с systemd и D-Bus.

   ![Конфигурационные файлы dnsmasq](Screenshot_21.png){ #fig:021 width=80% }

5. Был выполнен вывод скриптов пакета dnsmasq, выполняемых при установке, обновлении и удалении.  
   Скрипты предназначены для:

   - **создания системного пользователя `dnsmasq`** при установке;  
   - **регистрации системной службы dnsmasq в systemd**;  
   - **обновления конфигураций и unit-файлов при обновлении пакета**;  
   - **корректного удаления службы при деинсталляции пакета**.

   Скрипты обеспечивают правильную интеграцию dnsmasq в систему и автоматическую настройку окружения.

6. После выполнения всех операций пакет dnsmasq был удалён командой `rpm -e dnsmasq`.  
   Пакет успешно удалён, что подтверждает отсутствие ошибок в выводе.

# Контрольные вопросы

1. Для поиска rpm-пакета, содержащего файл `useradd`, используется команда  
   `rpm -qf $(which useradd)` или при неизвестном расположении файла — `rpm -q --whatprovides /usr/sbin/useradd`.

2. Чтобы вывести имя группы dnf, содержащей инструменты безопасности, и посмотреть её состав, используются команды  
   `dnf groups list` — для вывода всех групп  
   `dnf groups info "Security Tools"` — для просмотра содержимого группы.

3. Для установки rpm-пакета, загруженного из Интернета и не входящего в репозитории, используют команду  
   `rpm -Uhv пакет.rpm`.

4. Чтобы убедиться, что скачанный rpm не содержит опасных скриптов, проверяют его содержимое командой  
   `rpm -q --scripts пакет`.

5. Для отображения всей документации из rpm необходимо выполнить команду  
   `rpm -qd пакет`.

6. Чтобы определить, какому rpm-пакету принадлежит конкретный файл, применяется команда  
   `rpm -qf /путь/к/файлу`.

# Заключение

В ходе выполнения лабораторной работы были подробно изучены механизмы управления программными пакетами в системе Rocky Linux с использованием утилит `dnf` и `rpm`. Были освоены способы поиска, установки и удаления пакетов, а также рассмотрены возможности анализа содержимого пакетов, включая отображение файлов, документации, конфигураций и установочных скриптов. Практическая работа с rpm-пакетами позволила наглядно оценить, как происходит их интеграция в систему, какие вспомогательные действия выполняются при установке и обновлении, и как обеспечивается корректная работа сервисов.

Дополнительно были изучены группы пакетов dnf, методы отката транзакций и управление локально загруженными rpm-файлами. В результате сформировано целостное понимание принципов пакетного менеджмента и особенностей его применения для администрирования Linux-систем. Полученные навыки являются фундаментальными для дальнейшей работы с серверными конфигурациями, развёртыванием ПО и обеспечением безопасности системы.
