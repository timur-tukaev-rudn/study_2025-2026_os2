---
## Front matter
title: "Отчёт по лабораторной работе №16"
subtitle: "Программный RAID"
author: "Тукаев Тимур"

## Generic otions
lang: ru-RU
toc-title: "Содержание"

## Bibliography
bibliography: bib/cite.bib
csl: pandoc/csl/gost-r-7-0-5-2008-numeric.csl

## Pdf output format
toc: true
toc-depth: 2
lof: true
lot: true
fontsize: 12pt
linestretch: 1.5
papersize: a4
documentclass: scrreprt
## I18n polyglossia
polyglossia-lang:
  name: russian
  options:
    - spelling=modern
    - babelshorthands=true
polyglossia-otherlangs:
  name: english
## I18n babel
babel-lang: russian
babel-otherlangs: english
## Fonts
mainfont: IBM Plex Serif
romanfont: IBM Plex Serif
sansfont: IBM Plex Sans
monofont: IBM Plex Mono
mathfont: STIX Two Math
mainfontoptions: Ligatures=Common,Ligatures=TeX,Scale=0.94
romanfontoptions: Ligatures=Common,Ligatures=TeX,Scale=0.94
sansfontoptions: Ligatures=Common,Ligatures=TeX,Scale=MatchLowercase,Scale=0.94
monofontoptions: Scale=MatchLowercase,Scale=0.94,FakeStretch=0.9
mathfontoptions:
## Biblatex
biblatex: true
biblio-style: "gost-numeric"
biblatexoptions:
  - parentracker=true
  - backend=biber
  - hyperref=auto
  - language=auto
  - autolang=other*
  - citestyle=gost-numeric
## Pandoc-crossref LaTeX customization
figureTitle: "Рис."
tableTitle: "Таблица"
listingTitle: "Листинг"
lofTitle: "Список иллюстраций"
lotTitle: "Список таблиц"
lolTitle: "Листинги"
## Misc options
indent: true
header-includes:
  - \usepackage{indentfirst}
  - \usepackage{float}
  - \floatplacement{figure}{H}
---

# Цель работы

Освоить работу с RAID-массивами при помощи утилиты mdadm.

# Выполнение

## Создание RAID-диска

1. Получены права администратора с помощью команды `su`. После ввода пароля выполнен переход в окружение суперпользователя.

   ![Получение прав администратора](Screenshot_1.png){ #fig:001 width=80% }

2. Проверено наличие дополнительных дисков. Команда `fdisk -l | grep /dev/sd` показала устройства `/dev/sdd`, `/dev/sde`, `/dev/sdf`, что подтверждает их успешное добавление.

   ![Просмотр списка дисков](Screenshot_2.png){ #fig:002 width=80% }

3. На дисках `/dev/sdd`, `/dev/sde`, `/dev/sdf` созданы новые разделы.

   ![Создание разделов](Screenshot_3.png){ #fig:003 width=80% }

4. Проверены типы созданных разделов. Все разделы имели тип **83 (Linux)**.

5. Просмотрены доступные типы RAID-партиций. Определено, что для RAID используется тип `fd (Linux raid autodetect)`.

6. Типы разделов изменены на **fd Linux raid autodetect**.

7. Просмотрено состояние дисков после изменения типа. На всех дисках отображается корректный идентификатор RAID.

   ![Состояние дисков после изменения типа](Screenshot_4.png){ #fig:004 width=80% }

8. Проверено наличие утилиты `mdadm` — она была установлена в системе.

9. Создан массив RAID 1 из двух дисков `/dev/sdd1` и `/dev/sde1`.

   ![Создание массива RAID1](Screenshot_5.png){ #fig:005 width=80% }

10. Выполнена проверка состояния массива. По данным `/proc/mdstat`, `mdadm --query`, `mdadm --detail`:

    * массив работает в режиме **clean**  
    * оба устройства синхронизированы  
    * отказов и ошибок нет  

    ![Состояние массива RAID](Screenshot_6.png){ #fig:006 width=80% }

11. На RAID-массиве создана файловая система `ext4`.

12. RAID смонтирован в каталог `/mnt/raid`.

    ![Создание ФС и монтирование](Screenshot_7.png){ #fig:007 width=80% }

13. Для автомонтирования добавлена запись в `/etc/fstab`:

    ```
    /dev/md0   /mnt/raid   ext4   defaults   1 2
    ```

    ![Запись в fstab](Screenshot_8.png){ #fig:008 width=80% }

14. Сымитирован сбой диска `/dev/sde1`.

15. Сбойный диск удалён из RAID-массива.

16. В массив добавлен новый диск `/dev/sdf1`.

17. Выполнена повторная проверка RAID. Массив снова в состоянии **clean**, устройства синхронизированы.

    ![Состояние массива после замены диска](Screenshot_9.png){ #fig:009 width=80% }

18. RAID размонтирован, остановлен, и метаданные очищены на всех задействованных дисках.

    ![Удаление массива и очистка метаданных](Screenshot_10.png){ #fig:010 width=80% }

## RAID-массив с горячим резервом (hotspare)

1. Получены права администратора и выполнен переход к суперпользователю.

2. Создан массив RAID 1 из двух дисков `/dev/sdd1` и `/dev/sde1`. Массив был успешно инициализирован.

   ![Создание RAID1](Screenshot_11.png){ #fig:011 width=80% }

3. В массив добавлен третий диск `/dev/sdf1`, который автоматически назначен как **горячий резерв (spare)**.

4. RAID-массив подмонтирован командой `mount /dev/md0`.

5. Проверено состояние массива.  

   По выводу `/proc/mdstat` и `mdadm --detail` видно, что:

   - два устройства активны (`active sync`)
   - третье устройство — **spare**
   - состояние массива — **clean**

   ![Состояние массива с hotspare](Screenshot_12.png){ #fig:012 width=80% }

6. Смоделирован сбой диска `/dev/sde1`.  

7. Повторно проверено состояние массива.  

   Один диск перешёл в статус **faulty**, запасной диск (`/dev/sdf1`) автоматически подключился вместо неисправного.

   Массив продолжил работу в состоянии **clean**, что подтверждает автоматическую пересборку.

   ![Состояние после сбоя](Screenshot_13.png){ #fig:013 width=80% }

8. Выполнено удаление массива:

   - RAID размонтирован  
   - остановлен  
   - очищены метаданные всех трёх дисков  

## Преобразование массива RAID 1 → RAID 5

1. Получены права администратора.

2. Создан новый массив RAID 1 из двух дисков `/dev/sdd1` и `/dev/sde1`.

3. В массив добавлен третий диск `/dev/sdf1`.

4. RAID подмонтирован.

5. Проверено состояние массива.  

   По выводу:

   - два устройства — активные  
   - третье — запасное  
   - состояние массива — **clean**

   ![RAID1 с добавленным диском](Screenshot_14.png){ #fig:014 width=80% }

6. Тип массива преобразован в RAID 5 командой изменения уровня массива.

7. Проверено состояние массива.  

   Теперь массив:

   - работает как **RAID 5**
   - содержит 3 устройства (2 активных + 1 spare)
   - состояние — **clean**

   ![Преобразованный RAID5](Screenshot_15.png){ #fig:015 width=80% }

8. Изменено количество устройств RAID 5 до трёх активных дисков.

9. Проверено состояние массива после расширения:

   - все 3 устройства активны (`active sync`)
   - массив полностью функционирует как RAID 5
   - ошибок нет

   ![RAID5 из трёх активных дисков](Screenshot_16.png){ #fig:016 width=80% }

10. Массив удалён: размонтирован, остановлен, метаданные очищены.

11. Запись в `/etc/fstab`, относящаяся к `/dev/md0`, была закомментирована.

   ![fstab обновлён](Screenshot_17.png){ #fig:017 width=80% }

# Контрольные вопросы

1. RAID представляет собой технологию объединения нескольких физических дисков в единый логический массив для повышения отказоустойчивости, производительности или обоих параметров одновременно.  

2. В настоящее время используются следующие типы RAID-массивов: RAID 0, RAID 1, RAID 5, RAID 6, RAID 10, а также комбинированные и программные реализации, предлагающие различные уровни защиты и скорости.  

3. RAID 0 обеспечивает разделение данных на блоки и запись их на несколько дисков параллельно, что повышает производительность, но полностью исключает отказоустойчивость; RAID 1 использует зеркалирование данных между дисками, обеспечивая надежную защиту от отказов за счёт дублирования; RAID 5 распределяет данные и информацию четности по всем дискам массива, что позволяет восстановить данные при выходе из строя одного диска без значительной потери производительности; RAID 6 использует двойную четность, обеспечивая возможность пережить одновременный отказ двух дисков, что делает его подходящим для систем, требующих высокой степени надежности.

# Заключение

В ходе лабораторной работы были изучены принципы создания, настройки и управления программными RAID-массивами в Linux.  
Были рассмотрены особенности работы уровней RAID 1 и RAID 5, включая использование горячего резерва, замену отказавших устройств и динамическое преобразование массива.  
Практические шаги позволили закрепить навыки диагностики состояния RAID, работы с утилитой `mdadm`, а также понимание алгоритмов отказоустойчивости и распределения данных в массиве.  
Полученные результаты демонстрируют, как программный RAID повышает надежность и гибкость хранения данных в современных системах.
